package me.kansio.client.modules.impl.exploit.disabler.misc;

import me.kansio.client.event.impl.PacketEvent;
import me.kansio.client.event.impl.UpdateEvent;
import me.kansio.client.modules.impl.exploit.disabler.DisablerMode;
import me.kansio.client.utils.chat.ChatUtil;
import me.kansio.client.utils.network.PacketUtil;
import net.minecraft.network.play.client.C00PacketKeepAlive;
import net.minecraft.network.play.client.C0FPacketConfirmTransaction;

import java.util.LinkedList;

public class Test4 extends DisablerMode {
    private LinkedList<C0FPacketConfirmTransaction> c0fQueue = new LinkedList<>();
    public Test4() {
        super("Test 4");
    }

    @Override
    public void onUpdate(UpdateEvent event) {
        if (!event.isPre()) return;
        if (mc.thePlayer.ticksExisted % 120 == 0) {
            ChatUtil.log(c0fQueue.size() + "");
            while (c0fQueue.size() > 44) {
                PacketUtil.sendPacketNoEvent(c0fQueue.poll());
            }
        }
    }

    @Override
    public void onPacket(PacketEvent event) {
        if (event.getPacket() instanceof C0FPacketConfirmTransaction) {
            c0fQueue.add(event.getPacket());
        }
        if (event.getPacket() instanceof C00PacketKeepAlive) {
            c0fQueue.add(event.getPacket());
        }
    }
}
