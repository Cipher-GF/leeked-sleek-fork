package me.kansio.client.modules.impl.exploit;

import dorkbox.messageBus.annotations.Subscribe;
import me.kansio.client.event.PacketDirection;
import me.kansio.client.event.impl.PacketEvent;
import me.kansio.client.modules.api.ModuleCategory;
import me.kansio.client.modules.impl.Module;
import me.kansio.client.property.value.ModeValue;
import me.kansio.client.utils.chat.ChatUtil;
import me.kansio.client.utils.network.PacketUtil;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C00PacketKeepAlive;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C0CPacketInput;

public class Disabler extends Module {

    private ModeValue modeValue = new ModeValue("Mode", this, "Keep-Alive", "Vehicle");

    public Disabler() {
        super("Disabler", ModuleCategory.EXPLOIT);
        register(modeValue);
    }

    @Override
    public void onEnable() {

    }

    @Subscribe
    public void onSendPacket(PacketEvent event) {
        Packet packet = event.getPacket();

        if (event.getPacketDirection() != PacketDirection.OUTBOUND)  return;

        switch (modeValue.getValueAsString()) {
            case "Keep-Alive": {
                if (event.getPacket() instanceof C00PacketKeepAlive) {
                    event.setCancelled(true);
                }
                break;
            }
            case "Vehicle": {
                if (event.getPacket() instanceof C03PacketPlayer) {
                    PacketUtil.sendPacketNoEvent(new C0CPacketInput());
                }
                break;
            }
        }
    }

    @Override
    public String getSuffix() {
        return " " + modeValue.getValueAsString();
    }
}
